---
title: "Diario de desarrollo #1: Gu√≠a Vegana"
description: "C√≥mo desarroll√© mi proyecto personal: Gu√≠aVegana. Desde 0 hasta producci√≥n. Idea, desarrollo y despliegue"
date: 2024-12-31T19:00:39.123Z
preview: ../../assets/guia-vegana.webp
draft: false
tags: 
    - guiavegana
    - programacion
    - personal
    - web
categories: 
    - programacion 
    - personal 
    - web
author: "Thiago Granata"
relatedPosts: 
    - como-desarrolle-mi-blog
    - servidor-cliente
published: true
---
import Callout from '../../components/ui/Callout.astro'


# Introducci√≥n

[Gu√≠a Vegana](https://guiavegana.ar) es un proyecto que quise hacer durante mucho tiempo, incluso lo hab√≠a comenzado en m√∫ltiples ocasiones, pero nunca hab√≠a logrado llevarlo a cabo completamente. 
Fue hace, apr√≥ximadamente, dos meses cuando decid√≠ tomarmelo enserio y desarrollarlo de principio a fin. La idea era simple: *quer√≠a recolectar m√∫ltiples restaurantes ubicados en Argentina que cuenten con opciones veganas*.
Si bien esto es algo que ya existe, no hab√≠a lugares destacados a nivel local y me parec√≠a que pod√≠a sumarle algunas features interesantes.

## El Stack Tecnol√≥gico

Mi objetivo a nivel t√©cnico con el frontend era desarrollar una aplicaci√≥n con un rendimiento s√≥lido y un buen SEO para lograr el mayor alcance posible de manera org√°nica. Para esto, mi idea era generar pr√°cticamente todas las p√°ginas
de manera est√°tica y solo renderizar din√°micamente (client-side) aquellas secciones que **realmente** lo necesiten. Debido a estos requerimientos, sumado a mi entretenimiento personal (realmente me gusta *mucho* el framework) y la experiencia de desarrollo, decid√≠ utilizar **Astro** 

Por el lado del backend, no ten√≠a muchas alternativas si quer√≠a mantener los tiempos de desarrollo breves, considerando que en ese campo s√≥lo utilic√© Node, me parec√≠a una opci√≥n id√≥nea.

En resumidas cuentas:
- Astro
- React (para esos componentes que requieran mayor interactividad)
- Node (Express)
- MongoDB

En su momento consider√© que este stack era m√°s que suficiente para construir lo que quer√≠a. Y creo que no me equivoqu√©.

## Construyendo Gu√≠a Vegana

Lo primero que hice para comenzar a construir el proyecto fue sin duda lo m√°s importante: **comprar el dominio**. Uno m√°s a la lista. Pero tambi√©n adquir√≠ el dominio como una forma de obligarme
a terminar el proyecto. No estaba del todo seguro qu√© dominio comprar, pero me termin√© decidiendo por [https://guiavegana.ar](https://guiavegana.ar)

Para ahorra tiempo, utilic√© un [starter](https://github.com/tomihq/express-joi-typescript) que me permiti√≥ configurar r√°pidamente el backend con un skeleton preparado. Model√© la base de datos y cre√© un cluster en [MongoDB Atlas](https://www.mongodb.com/products/platform/atlas-database). Agregu√© algunos datos dummies y con
eso ya ten√≠a un backend funcional, lo cual era m√°s que suficiente para comenzar el desarrollo del frontend.

Realmente el desarollo del frontend no requiri√≥ un gran trabajo, finalmente el sitio funciona como un listado, por lo que es relativamente f√°cil de hacer. Sin embargo, hay algunas cuestiones 
que surgieron durante el desarrollo que me parece interesante comentar:

### Generaci√≥n de p√°ginas y filtrado

Como coment√© mi idea era generar la mayor cantidad de p√°ginas de manera est√°tica, esto est√° buenisimo, pero trae consigo una serie de limitaciones, especialmente cuando intentamos implemntar
filtros con una buena experiencia de usuario. Mi plan inicial era implementar los filtros mediante query params, de esta manera podr√≠a manejar el estado por la URL y la experiencia ser√≠a
mejor al compartir una p√°gina con filtros aplicados. El problema viene que al generar la p√°gina utilizando `getStaticPaths`, l√≥gicamente no tenemos acceso a esos p√°rametros.

Para no perder los beneficios que otorga la generaci√≥n est√°tica, mi soluci√≥n fue contar con dos paths:
- `/restaurantes/[...provincia]` -> esto se genera de manera est√°tica, utilizando `getStaticPaths`
- `/buscar` -> esto se renderiza del lado del servidor

Entonces, cuando el usuario aplica un filtro en `/restaurantes/[...provincia]` s√≥lo se lo redirige a, por ejemplo, `/buscar/?provincia=[provincia]&categoria=Vegano`. De esta manera, podemos
contar con lo mejor de los dos mundos.

Por otro lado, la paginaci√≥n no necesit√≥ mucho trabajo, gracias a que Astro cuenta con una manera built-in de realizarla. Para aquellos interesados, pueden encontrar m√°s informaci√≥n [ac√°](https://docs.astro.build/en/guides/routing/#pagination)

### Registro de usuarios

El registro de usuarios tuvo algunas particularidades, porque la mayor√≠a de integraciones que nos permiten resolver este problema f√°cilmente utilizan servicios externos (como Supabase, Firebase, Clerk, etc) y si bien esto no es
malo yo quer√≠a manejar los usuarios directamente en mi backend. Decid√≠ gestionar la sesi√≥n del usuario utilizando un middleware y cookies, el middleware ser√≠a el encargado de verificar
si un usuario est√° logeado y agregar√≠a la data relevante de ese usuario a la request en caso de estarlo.

Ahora necesitaba encontrar la manera de que un componente pueda ser "actualizado" por el servidor para mostrar el estado del usuario (es decir, si tiene o no la sesi√≥n iniciada). No estaba muy seguro como lograr esto, y fue en ese momento, revisando el [discord de Astro](https://astro.build/chat) y su documentaci√≥n
donde me encontr√© con el concepto de [Server Islands](https://astro.build/blog/future-of-astro-server-islands/).
Lo que nos permite un Server Island es enviar un HTML placeholder mientras que se carga el componente final del lado del servidor, que posteriormente reemplazar√° ese placeholder. Para realizar un pararelismo, podr√≠amos decir que funciona parecido al `<Suspense>` de React.

Gracias a esta tecnolog√≠a, puedo cargar un avatar temporal mientras verifico si el usuario est√° logeado o no, y luego, enviar el HTML correspondiente al cliente dependiendo del resultado de la verificaci√≥n. 

### SEO

El SEO es una parte importante del proyecto, finalmente es lo que nos va a posicionar en Google. Por esto mismo es que intent√© generar la mayor cantidad de p√°ginas de forma est√°tica.
La optimizaci√≥n de los tiempos de carga es fundamental de cara a tener un buen SEO. Adicionalmente me preocup√© por intentar tener los datos estructurados lo m√°s completos posibles. 

Pr√°cticamente todo el contenido relevante de GuiaVegana tiene un Schema por detr√°s. Los restaurantes, los listados, los breadcrumbs, los FAQs, los art√≠culos, el blog e incluso el mismo sitio posee un [Organization Schema](https://schema.org/Organization)
en su ra√≠z. 

Tambi√©n prepar√© un peque√±o blog para escribir contenido y que el tr√°fico tambi√©n pueda venir desde b√∫squedas relacionadas a ese contenido (por ejemplo: experiencias en restaurantes o eventos veganos). Lamentablemente no tuve la oportunidad de aprovecharlo
como se debe, pero es algo que sin duda quiero visitar en un futuro cercano. 


## Desplegando el proyecto

Para llevar el proyecto a producci√≥n utilic√© tres servicios: [Vercel](https://vercel.com/) (frontend), [DigitalOcean](https://www.digitalocean.com/) (backend) y [Cloudflare](https://cloudflare.com) (dominios/mailing). 

Desplegar un proyecto en Vercel es bastante directo, solamente linkeamos nuestro Github/Gitlab y seleccionamos el proyecto que queremos. 
Vercel se encarga del resto siempre y cuando sea una tecnolog√≠a soportada por la plataforma. En este caso, Astro es perfecto, tiene un adaptador que funciona sin problemas ni configuraciones extremas con Vercel ([@astro/vercel](https://vercel.com/docs/frameworks/astro))

A nivel frontend entonces, desplegar la aplicaci√≥n no requiere de m√°s que 
```bash
git add .
git commit -m "new feature üòÅ"
git push origin main
```

En cuanto al backend y DigitalOcean, si bien requiere mayor configuraci√≥n que Vercel, tampoco es una tarea tan complicada. Me ayud√© de dos art√≠culos para lograrlo:

- [How to Set Up a Node.js Application for Production on Ubuntu 20.04](https://www.digitalocean.com/community/tutorials/how-to-set-up-a-node-js-application-for-production-on-ubuntu-20-04)
- [Levantar un servidor de Node en DigitalOcean con PM2, NGINX, Dominio Personalizado y Certificado SSL](https://tomihq-dev.vercel.app/blog/pm2-nginx-digitalocean-domain-ssl-certificate)

En ellos est√° pr√°cticamente todo lo necesario para pasar nuestro proyecto a producci√≥n.

El dominio lo compr√© en [nic.ar](https://nic.ar/) que es la entidad encargada de administrar los dominios para el ccTLD .ar. Sin embargo, esta entidad solo nos otorga la "titularidad" del dominio
pero no es suficiente si queremos configurar los DNS de manera tal que una persona pueda ingresar a √©l por internet. Este proceso de "delegar" el dominio es breve y si hicimos algo parecido antes no vamos a tener problemas.

<Callout>
<a style="color: #fff;" href="https://gonzalohirsch.com/blog/delegating-com-ar-domains-using-cloudflare/">Esta gu√≠a</a> puede resultarles de ayuda a aquellos que no hayan tenido experiencias previas.
</Callout>

Por √∫ltimo, configur√© el correo `hola@guiavegana.ar` utilizando [Cloudflare Email Routing](https://blog.cloudflare.com/introducing-email-routing/), que si bien no act√∫a como un proveedor de correos corporativos tradicional (como Google Workspace o Zoho Mail),
funcionaba perfecto para mi caso. Simplemente quer√≠a tener un correo electr√≥nico que permita diferenciar a Gu√≠aVegana de mi correo personal, pero realmente no necesitaba tener una bandeja de entrada adicional. Entonces era suficiente con poder enviar mails a ese dominio y que lleguen a mi bandeja personal.

Algo que no est√° del todo relacionado con este art√≠culo, pero no deja de ser interesante, es que con el fin de tener una bandeja de entrada m√°s organizada decid√≠ agregar tags a los correos que lleguen a mi bandeja
de entrada mediante `hola@guiavegana.ar`. Es f√°cil de hacer y realmente deja mucho m√°s claro el objetivo de cada correo. 

Yo lo hice con Gmail: nos tenemos que dirigir a nuestra bandeja de entrada -> configuraci√≥n -> filtros y direcciones bloqueadas -> crear filtro. 

![Configuraci√≥n de Tags](https://res.cloudinary.com/dcb31ckjr/image/upload/v1735994183/guia-vegana/screenshot_xwi39k.png)

Nos va a abrir un peque√±o popup donde tenemos que hacer dos modificaciones, primero poner la direcci√≥n de nuestro correo de Cloudflare en el campo "Para", luego presionamos "Crear filtro"
![Configurar filtro para tag](https://res.cloudinary.com/dcb31ckjr/image/upload/v1735994419/guia-vegana/screenshot_1_ppknln.png)

Y por √∫ltimo marcar el campo "Aplicar la etiqueta" junto a la etiqueta que querramos que aparezca en el correo.

![Aplicar etiqueta al filtro creado](https://res.cloudinary.com/dcb31ckjr/image/upload/v1735994436/guia-vegana/screenshot_2_rpcvrp.png)

Con esa configuraci√≥n, a cada correo que llegue a la direcci√≥n que configuramos se le va a asignar una etiqueta autom√°ticamente, lo que nos permite detectar r√°pidamente el target
del correo.

## Conclusi√≥n

Considero que desarrollar este proyecto me sirvi√≥ mucho, tuve la oportunidad de profundizar en √°reas que quiz√° no controlo tanto en mi d√≠a a d√≠a laboral y, adem√°s, la oportunidad
de trabajar en algo que ten√≠a ganas hace mucho tiempo. Todav√≠a me quedan muchas ideas para implementar en Gu√≠aVegana, pero en este momento no cuento con tanto tiempo para realizarlas.

Sin embargo, mi idea es continuar desarrollando el proyecto y continuar escribiendo sobre √©l sin importar cuanto tiempo pase entre cada Diario de Desarrollo.